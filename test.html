<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Stylus Test</title>
<style>
  * { margin: 0; padding: 0; }
  body { background: #111; color: #eee; font-family: monospace; font-size: 14px; touch-action: none; }
  canvas { display: block; width: 100%; height: 60vh; background: #000; touch-action: none; }
  #log { padding: 12px; height: 40vh; overflow-y: auto; white-space: pre; font-size: 11px; }
  .down { color: #4f4; }
  .move { color: #888; }
  .up { color: #f44; }
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="log"></div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const log = document.getElementById('log');
const dpr = window.devicePixelRatio || 1;

function resize() {
  canvas.width = canvas.clientWidth * dpr;
  canvas.height = canvas.clientHeight * dpr;
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
}
resize();
window.addEventListener('resize', resize);

function addLog(cls, msg) {
  const line = document.createElement('div');
  line.className = cls;
  line.textContent = msg;
  log.prepend(line);
  if (log.children.length > 200) log.lastChild.remove();
}

let prev = null;

canvas.addEventListener('pointerdown', e => {
  e.preventDefault();
  canvas.setPointerCapture(e.pointerId);
  prev = { x: e.clientX, y: e.clientY };
  addLog('down', `DOWN  type=${e.pointerType} id=${e.pointerId} pressure=${e.pressure.toFixed(3)} x=${Math.round(e.clientX)} y=${Math.round(e.clientY)} tiltX=${e.tiltX} tiltY=${e.tiltY}`);
});

canvas.addEventListener('pointermove', e => {
  if (!prev) return;
  ctx.strokeStyle = '#fff';
  ctx.lineWidth = Math.max(1, e.pressure * 10);
  ctx.lineCap = 'round';
  ctx.beginPath();
  ctx.moveTo(prev.x, prev.y);
  ctx.lineTo(e.clientX, e.clientY);
  ctx.stroke();
  prev = { x: e.clientX, y: e.clientY };
});

canvas.addEventListener('pointerup', e => {
  prev = null;
  addLog('up', `UP    type=${e.pointerType} id=${e.pointerId}`);
});

canvas.addEventListener('pointercancel', e => {
  prev = null;
  addLog('up', `CANCEL type=${e.pointerType} id=${e.pointerId}`);
});

document.addEventListener('pointerdown', e => {
  if (e.target !== canvas) {
    addLog('down', `DOC-DOWN target=${e.target.id || e.target.tagName} type=${e.pointerType}`);
  }
}, true);

addLog('move', 'Ready â€” draw on the canvas above');
</script>
</body>
</html>
